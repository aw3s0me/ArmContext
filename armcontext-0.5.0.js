(function(a){a.ArmContext={_lastUnicalNumber:0,GetNewUnicalNumber:function(){return this._lastUnicalNumber+=1}}})(window);(function(){ArmContext.InternalRepresentation=function(){var a={};a._points=new $M([[0,0,1]]);a.GetPoints=function(){return this._points.elements};a.ShowPoints=function(b){var a=this.GetPoints();b.save();b.beginPath();for(var e in a)b.moveTo(a[e][0],a[e][1]),b.arc(a[e][0],a[e][1],3,0,2*Math.PI,!1);b.closePath();CTX.fillStyle="#ff0000";b.stroke();b.fill();b.restore();return this};a.ShowDebugInfo=function(){var b=this.GetPoints();console.log("Points of internal representation");for(var a in b)console.log(b[a])};
return a}})();(function(){ArmContext.GlobalRepresentation=function(){var a={};a._points=new $M([[0,0,1]]);a._polygone=new gizmo.Math.Polygone(a._points.elements);a.GetPoints=function(){return this._points.elements};a.SetPoints=function(b){gizmo.Filter(b,"Array");this._points.elements=b};a.GetMatrixOfPoints=function(){return this._points};a.SetMatrixOfPoints=function(b){gizmo.Filter(b,"Object");return this._points=b};a.Update=function(b,a,e){gizmo.Filter(b,"Object");gizmo.Filter(a,"Object");gizmo.Filter(e,"Object");
this.SetPoints(b.GetPoints());this.SetMatrixOfPoints(this.GetMatrixOfPoints().x(e.GetMatrix()));this.UpdatePolygone();return this};a.UpdatePolygone=function(){arrVectors=[];var b=this.GetPoints(),a;for(a in b)arrVectors.push(new gizmo.Math.Vector2D(b[a][0],b[a][1]));this._polygone=new gizmo.Math.Polygone(arrVectors);return this};a.HasPoint=function(b,a){gizmo.Filter(b,"Number");gizmo.Filter(a,"Number");return this._polygone.HasPoint({x:b,y:a})};a.ShowDebugInfo=function(){var b=this.GetPoints();console.log("Points of global representation");
for(var a in b)console.log(b[a])};a.ShowPoints=function(){var b=this.GetPoints(),a;for(a in b)CTX.save(),CTX.beginPath(),CTX.fillStyle="#00ff00",CTX.rect(b[a][0]-2,b[a][1]-2,4,4),CTX.stroke(),CTX.fill(),CTX.closePath(),CTX.restore()};return a}})();(function(){ArmContext.C2dContextRepresentation=function(){return{_ctx:null,_layer:null,_globalAlpha:"default",_shadowColor:"default",_shadowBlur:"default",_shadowOffsetX:"default",_shadowOffsetY:"default",_boundingBox:{},_pictureUnderPrimitive:{},Update:function(a){this._ctx=a.ctx||this._ctx;this._ctx=(this._layer=a.layer||this._layer)?this._layer.GetCtx():this._ctx;this._globalAlpha=a.globalAlpha||this._globalAlpha;this._shadowColor=a.shadowColor||this._shadowColor;this._shadowBlur=a.shadowBlur||
this._shadowBlur;this._shadowOffsetX=a.shadowOffsetX||this._shadowOffsetX;this._shadowOffsetY=a.shadowOffsetY||this._shadowOffsetY},GetCtx:function(){return this._ctx},GetGlobalAlpha:function(){return this._globalAlpha},GetShadowColor:function(){return this._shadowColor},GetShadowBlur:function(){return this._shadowBlur},GetShadowOffsetX:function(){return this._shadowOffsetX},GetShadowOffsetY:function(){return this._shadowOffsetY},ShowDebugInfo:function(){console.log("VisualProperties:");console.log("Method have not realisation")}}}})();(function(){ArmContext.MvMatrix=function(){var a={};a._matrix=new $M([[1,0,0],[0,1,0],[0,0,1]]);a.Rotate=function(b){var a=Math.cos(b),b=Math.sin(b),a=new $M([[a,b,0],[-b,a,0],[0,0,1]]);this._matrix=this._matrix.x(a);return this};a.Scale=function(b,a){gizmo.Filter(b,"Number");gizmo.Filter(a,"Number");var e=new $M([[b,0,0],[0,a,0],[0,0,1]]);this._matrix=this._matrix.x(e);return this};a.Translate=function(b,a){gizmo.Filter(b,"Number");gizmo.Filter(a,"Number");var e=new $M([[1,0,0],[0,1,0],[b,a,1]]);
this._matrix=this._matrix.x(e);return this};a.Scos=function(b,a){gizmo.Filter(b,"Number");gizmo.Filter(a,"Number");var e=new $M([[1,a,0],[b,1,0],[0,0,1]]);this._matrix=this._matrix.x(e);return this};a.GetMatrix=function(){return this._matrix};a.GetTransformParams=function(){var a=this.GetMatrix();return{a:a.elements[0][0],b:a.elements[0][1],c:a.elements[1][0],d:a.elements[1][1],e:a.elements[2][0],f:a.elements[2][1]}};a.ShowDebugInfo=function(){var a=this.GetMatrix();console.log("mvMatrix:");console.log(a.elements[0]);
console.log(a.elements[1]);console.log(a.elements[2])};return a}})();(function(){ArmContext.Debug=function(a){gizmo.Filter(a,"Object");var b={};b.object=a;b.ShowDebugInfo=function(){console.log("<<Primitive>> DebugInfo");this.object._2dContextRepresentation.ShowDebugInfo();this.object._interalRepresentation.ShowDebugInfo();this.object._globalRepresentation.ShowDebugInfo();this.object._mvMatrix.ShowDebugInfo()};return b}})();(function(a){a.ArmContext.Primitie=function(){var a={_internalRepresentation:null,_2dContextRepresentation:null,_globalRepresentation:null};a._mvMatrix=ArmContext.MvMatrix();a._debug=ArmContext.Debug(a);a.TranslateTo=function(a){gizmo.Filter(a,"Object");gizmo.Filter(a.x,"Number");gizmo.Filter(a.y,"Number");var b=this._globalRepresentation.GetX(),f=this._globalRepresentation.GetY();this._mvMatrix.Translate(a.x-b,a.y-f);this._globalRepresentation.Update(this._internalRepresentation,this._2dContextRepresentation,
this._mvMatrix);return this};a.Translate=function(a){gizmo.Filter(a,"Object");gizmo.Filter(a.x,"Number");gizmo.Filter(a.y,"Number");this._mvMatrix.Translate(a.x,a.y);this._globalRepresentation.Update(this._internalRepresentation,this._2dContextRepresentation,this._mvMatrix);return this};a.Rotate=function(a){gizmo.Filter(a.gradAngle||a.radAngle,"Number");gizmo.Filter(a.x,"Number");gizmo.Filter(a.y,"Number");var b=a.radAngle||(360<a.gradAngle?a.gradAngle%360:a.gradAngle)/180*Math.PI;this._mvMatrix.Translate(-a.x,
-a.y);this._mvMatrix.Rotate(b);this._mvMatrix.Translate(a.x,a.y);this._globalRepresentation.Update(this._internalRepresentation,this._2dContextRepresentation,this._mvMatrix);return this};a.Scale=function(a){gizmo.Filter(a,"Object");gizmo.Filter(a.x,"Number");gizmo.Filter(a.y,"Number");var b=this._globalRepresentation.GetX(),f=this._globalRepresentation.GetY(),b=b-b*a.x,f=f-f*a.y;this._mvMatrix.Scale(a.x,a.y);this._mvMatrix.Translate(b,f);this._globalRepresentation.Update(this._internalRepresentation,
this._2dContextRepresentation,this._mvMatrix);return this};a.Scos=function(a){gizmo.Filter(a,"Object");gizmo.Filter(a.x,"Number");gizmo.Filter(a.y,"Number");this._mvMatrix.Scos(a.x,a.y);this._globalRepresentation.Update(this._internalRepresentation,this._2dContextRepresentation,this._mvMatrix);return this};a.Draw=function(){console.log("Virtual method Draw");return this};a.Clear=function(){console.log("Virtual method Clear");return this};a.HasPoint=function(a){gizmo.Filter(a,"Object");gizmo.Filter(a.x,
"Number");gizmo.Filter(a.y,"Number");return this._globalRepresentation.HasPoint(a.x,a.y)};a.Update=function(a){this._internalRepresentation.Update(a);this._2dContextRepresentation.Update(a);this._globalRepresentation.Update(this._internalRepresentation,this._2dContextRepresentation,this._mvMatrix)};return a}})(window);(function(){ArmContext.Image2dContextRepresentation=function(){var a=ArmContext.C2dContextRepresentation();a.parentUpdate=a.Update?a.Update:null;a._image=null;a.GetImage=function(){return this._image};a.Update=function(a){this.parentUpdate&&this.parentUpdate(a);this._image=a.image||this._image};return a}})();(function(){ArmContext.ImageGlobalRepresentation=function(){var a=ArmContext.GlobalRepresentation();a.GetX=function(){return this.GetPoints()[0][0]};a.GetY=function(){return this.GetPoints()[0][1]};a.GetWidth=function(){this.GetPoints();return points[2][0]-points[0][0]};a.GetHeight=function(){this.GetPoints();return points[2][1]-points[0][1]};a.ShowPoints=function(){var a=this.GetPoints();CTX.save();CTX.beginPath();CTX.fillStyle="#ff0000";CTX.rect(a[0][0]-2,a[0][1]-2,4,4);CTX.stroke();CTX.fill();
CTX.closePath();CTX.restore();CTX.save();CTX.beginPath();CTX.fillStyle="#00ff00";CTX.rect(a[1][0]-2,a[1][1]-2,4,4);CTX.stroke();CTX.fill();CTX.closePath();CTX.restore();CTX.save();CTX.beginPath();CTX.fillStyle="#0000ff";CTX.rect(a[2][0]-2,a[2][1]-2,4,4);CTX.stroke();CTX.fill();CTX.closePath();CTX.restore();CTX.save();CTX.beginPath();CTX.fillStyle="#aaffbb";CTX.rect(a[3][0]-2,a[3][1]-2,4,4);CTX.stroke();CTX.fill();CTX.closePath();CTX.restore()};return a}})();(function(){ArmContext.ImageInternalRepresentation=function(){var a=new ArmContext.InternalRepresentation;this._height=this._width=10;a.GetWidth=function(){return this._width};a.SetWidth=function(a){gizmo.Filter(a,"Number");this.Update({width:a,height:this.GetHeight()})};a.GetHeight=function(){return this._height};a.SetHeight=function(a){gizmo.Filter(a,"Number");this.UpdatePoints({x:this.GetX(),y:this.GetY(),width:this.GetWidth(),height:a})};a.GetPointsOfMatrix=function(){return this._points};a.SetPointsOfMatrix=
function(a){gizmo.Filter(a,"Array");return this._points};a.Update=function(a){this._width=a.width||this._width;this._height=a.height||this._height;this._points=new $M([[0,0,1],[this._width,0,1],[this._width,this._height,1],[0,this._height,1]])};return a}})();(function(a){a.ArmContext.Image=function(a){gizmo.Filter(a,"Object");var d=ArmContext.Primitie();d._internalRepresentation=ArmContext.ImageInternalRepresentation();d._2dContextRepresentation=ArmContext.Image2dContextRepresentation();d._globalRepresentation=ArmContext.ImageGlobalRepresentation();d.Draw=function(){var a=this._2dContextRepresentation,b=this._internalRepresentation,c=a._ctx;c.save();params=this._mvMatrix.GetTransformParams();c.setTransform(params.a,params.b,params.c,params.d,params.e,
params.f);c.drawImage(a.GetImage(),0,0,b.GetWidth(),b.GetHeight());c.restore()};d.Update(a);return d}})(window);(function(){ArmContext.Rect2dContextRepresentation=function(){var a=ArmContext.C2dContextRepresentation();a.parentUpdate=a.Update?a.Update:null;a._fillObject="default";a._strokeObject="default";a._lineWidth="default";a._lineDash="default";a._miterLimit="default";a._lineCap="default";a._lineJoin="default";a.GetFillObject=function(){return this._fillObject};a.GetStrokeObject=function(){return this._strokeObject};a.GetLineWidth=function(){return this._lineWidth};a.GetLineDash=function(){return this._lineDash};
a.GetMiterLimit=function(){return this._miterLimit};a.GetLineCap=function(){return this._lineCap};a.GetLineJoin=function(){return this._lineJoin};a.Update=function(a){this.parentUpdate&&this.parentUpdate(a);this._fillObject=a.fillObject||this._fillObject;this._strokeObject=a.strokeObject||this._strokeObject;this._lineWidth=a.lineWidth||this._lineWidth;this._lineDash=a.lineDash||this._lineDash;this._miterLimit=a.miterLimit||this._miterLimit;switch(a.lineCap){case "butt":this._lineCap=a.lineCap;break;
case "round":this._lineCap=a.lineCap;break;case "square":this._lineCap=a.lineCap}switch(a.lineJoin){case "miter":this._lineJoin=a.lineJoin;break;case "round":this._lineJoin=a.lineJoin;break;case "bevel":this._lineJoin=a.lineJoin}};return a}})();(function(){ArmContext.RectGlobalRepresentation=function(){var a=ArmContext.GlobalRepresentation();a.GetX=function(){return this.GetPoints()[0][0]};a.GetY=function(){return this.GetPoints()[0][1]};a.GetWidth=function(){this.GetPoints();return points[2][0]-points[0][0]};a.GetHeight=function(){this.GetPoints();return points[2][1]-points[0][1]};a.ShowPoints=function(){var a=this.GetPoints();CTX.save();CTX.beginPath();CTX.fillStyle="#ff0000";CTX.rect(a[0][0]-2,a[0][1]-2,4,4);CTX.stroke();CTX.fill();CTX.closePath();
CTX.restore();CTX.save();CTX.beginPath();CTX.fillStyle="#00ff00";CTX.rect(a[1][0]-2,a[1][1]-2,4,4);CTX.stroke();CTX.fill();CTX.closePath();CTX.restore();CTX.save();CTX.beginPath();CTX.fillStyle="#0000ff";CTX.rect(a[2][0]-2,a[2][1]-2,4,4);CTX.stroke();CTX.fill();CTX.closePath();CTX.restore();CTX.save();CTX.beginPath();CTX.fillStyle="#aaffbb";CTX.rect(a[3][0]-2,a[3][1]-2,4,4);CTX.stroke();CTX.fill();CTX.closePath();CTX.restore()};return a}})();(function(){ArmContext.RectInternalRepresentation=function(){var a=new ArmContext.InternalRepresentation;this._height=this._width=10;a.GetWidth=function(){return this._width};a.SetWidth=function(a){gizmo.Filter(a,"Number");this.Update({width:a,height:this.GetHeight()})};a.GetHeight=function(){return this._height};a.SetHeight=function(a){gizmo.Filter(a,"Number");this.UpdatePoints({x:this.GetX(),y:this.GetY(),width:this.GetWidth(),height:a})};a.GetPointsOfMatrix=function(){return this._points};a.SetPointsOfMatrix=
function(a){gizmo.Filter(a,"Array");return this._points};a.Update=function(a){this._width=a.width||this._width;this._height=a.height||this._height;this._points=new $M([[0,0,1],[this._width,0,1],[this._width,this._height,1],[0,this._height,1]])};return a}})();(function(a){a.ArmContext.Rect=function(a){gizmo.Filter(a,"Object");var d=ArmContext.Primitie();d._internalRepresentation=ArmContext.RectInternalRepresentation();d._2dContextRepresentation=ArmContext.Rect2dContextRepresentation();d._globalRepresentation=ArmContext.RectGlobalRepresentation();d.Draw=function(){var a=this._2dContextRepresentation,b=this._internalRepresentation,c=a.GetCtx();c.save();c.beginPath();params=this._mvMatrix.GetTransformParams();c.setTransform(params.a,params.b,params.c,params.d,
params.e,params.f);c.rect(0,0,b.GetWidth(),b.GetHeight());c.closePath();"default"!=a.GetFillObject()&&c.setFillColor(a.GetFillObject());"default"!=a.GetStrokeObject()&&c.setStrokeColor(a.GetStrokeObject());"default"!=a.GetLineWidth()&&c.setLineWidth(a.GetLineWidth());"default"!=a.GetGlobalAlpha()&&c.setAlpha(a.GetGlobalAlpha());"default"!=a.GetShadowColor()&&(c.shadowColor=a.GetShadowColor());"default"!=a.GetShadowBlur()&&(c.shadowBlur=a.GetShadowBlur());"default"!=a.GetShadowOffsetX()&&(c.shadowOffsetX=
a.GetShadowOffsetX());"default"!=a.GetShadowOffsetY()&&(c.shadowOffsetY=a.GetShadowOffsetY());"default"!=a.GetLineCap()&&c.setLineCap(a.GetLineCap());"default"!=a.GetLineDash()&&c.setLineDash(a.GetLineDash());"default"!=a.GetLineJoin()&&c.setLineJoin(a.GetLineJoin());c.stroke();c.fill();c.restore()};d.Update(a);return d}})(window);(function(a){a.ArmContext.Layer=function(a){gizmo.Filter(a,"Object");var d={GetDefaultName:function(){return this._defaultName},SetCtx:function(a){gizmo.Filter(a,"CanvasRenderingContext2D");this._ctx=a},GetCtx:function(){return this._ctx},SetName:function(a){gizmo.Filter(a,"String");this._name=a},GetName:function(){return this._name},SetContainerElement:function(a){this._containerElement=a},SetCanvasElement:function(a){gizmo.Filter(a,"HTMLCanvasElement");this._canvasElement=a},Init:function(){var a;
a=null==this._containerElementName?document.getElementsByTagName("body")[0]:document.getElementById(this._containerElementName);var b=document.createElement("canvas");b.width=this._width;b.height=this._height;b.id=this._canvasElemetName;b.style.position="absolute";a.appendChild(b);var c=b.getContext("2d");this.SetName(this._canvasElementName);this.SetContainerElement(a);this.SetCanvasElement(b);this.SetCtx(c)},Set:function(a){this.SetName(a.name||this.GetName());d._canvasElementName=null==document.getElementById(this.GetName())?
this.GetName():this.GetName()+"."+ArmContext.GetNewUnicalNumber();this._containerElementName=a.container||this._containerElementName;this._width=a.width||this._width;this._height=a.height||this._height;this._left=a.left||this._left;this._top=a.top||this._top;this._zindex=a.zindex||this._zindex;this.Init()},_defaultName:"Layer",_ctx:null};d._name=d.GetDefaultName()+ArmContext.GetNewUnicalNumber();d._canvasElement=null;d._containerElement=null;d._width=500;d._height=500;d._left=0;d._top=0;d.Set(a);
return d}})(window);
